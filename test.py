json_data = {"QueryResponse": {"Bill": [{"DueDate": "2024-12-07", "VendorAddr": {"Id": "40", "Line1": "4528 Country Road", "City": "Middlefield", "CountrySubDivisionCode": "CA", "PostalCode": "94303", "Lat": "37.3752919", "Long": "-122.1692159"}, "Balance": 205.0, "domain": "QBO", "sparse": False, "Id": "126", "SyncToken": "0", "MetaData": {"CreateTime": "2024-12-07T13:10:36-08:00", "LastModifiedByRef": {"value": "9341453721658458"}, "LastUpdatedTime": "2024-12-07T13:10:36-08:00"}, "TxnDate": "2024-12-07", "CurrencyRef": {"value": "USD", "name": "United States Dollar"}, "Line": [{"Id": "1", "LineNum": 1, "Description": "Fountain Pump", "Amount": 80.0, "LinkedTxn": [], "DetailType": "ItemBasedExpenseLineDetail", "ItemBasedExpenseLineDetail": {"BillableStatus": "NotBillable", "ItemRef": {"value": "11", "name": "Pump"}, "UnitPrice": 10, "Qty": 8, "TaxCodeRef": {"value": "NON"}}}, {"Id": "2", "LineNum": 2, "Description": "Rock Fountain", "Amount": 125.0, "LinkedTxn": [], "DetailType": "ItemBasedExpenseLineDetail", "ItemBasedExpenseLineDetail": {"BillableStatus": "NotBillable", "ItemRef": {"value": "5", "name": "Rock Fountain"}, "UnitPrice": 125, "Qty": 1, "TaxCodeRef": {"value": "NON"}}}], "VendorRef": {"value": "46", "name": "Norton Lumber and Building Materials"}, "APAccountRef": {"value": "33", "name": "Accounts Payable (A/P)"}, "TotalAmt": 205.0}, {"SalesTermRef": {"value": "3"}, "DueDate": "2025-01-03", "VendorAddr": {"Id": "40", "Line1": "4528 Country Road", "City": "Middlefield", "CountrySubDivisionCode": "CA", "PostalCode": "94303", "Lat": "37.3752919", "Long": "-122.1692159"}, "Balance": 0, "domain": "QBO", "sparse": False, "Id": "25", "SyncToken": "1", "MetaData": {"CreateTime": "2024-12-04T15:37:25-08:00", "LastModifiedByRef": {"value": "9341453721658458"}, "LastUpdatedTime": "2024-12-07T12:56:17-08:00"}, "TxnDate": "2024-12-04", "CurrencyRef": {"value": "USD", "name": "United States Dollar"}, "LinkedTxn": [{"TxnId": "118", "TxnType": "BillPaymentCheck"}, {"TxnId": "26", "TxnType": "ReimburseCharge"}], "Line": [{"Id": "1", "LineNum": 1, "Description": "Lumber", "Amount": 103.55, "LinkedTxn": [{"TxnId": "26", "TxnType": "ReimburseCharge"}], "DetailType": "AccountBasedExpenseLineDetail", "AccountBasedExpenseLineDetail": {"CustomerRef": {"value": "26", "name": "Travis Waldron"}, "AccountRef": {"value": "64", "name": "Job Expenses:Job Materials:Decks and Patios"}, "BillableStatus": "HasBeenBilled", "TaxCodeRef": {"value": "NON"}}}], "VendorRef": {"value": "46", "name": "Norton Lumber and Building Materials"}, "APAccountRef": {"value": "33", "name": "Accounts Payable (A/P)"}, "TotalAmt": 103.55}, {"SalesTermRef": {"value": "1"}, "DueDate": "2024-10-22", "VendorAddr": {"Id": "33", "Line1": "10 Main St.", "City": "Palo Alto", "CountrySubDivisionCode": "CA", "PostalCode": "94303", "Lat": "37.445013", "Long": "-122.1391443"}, "Balance": 0, "domain": "QBO", "sparse": False, "Id": "105", "SyncToken": "1", "MetaData": {"CreateTime": "2024-12-06T13:43:56-08:00", "LastModifiedByRef": {"value": "9341453721658458"}, "LastUpdatedTime": "2024-12-07T12:55:23-08:00"}, "TxnDate": "2024-10-22", "CurrencyRef": {"value": "USD", "name": "United States Dollar"}, "LinkedTxn": [{"TxnId": "117", "TxnType": "BillPaymentCheck"}], "Line": [{"Id": "1", "LineNum": 1, "Amount": 56.5, "LinkedTxn": [], "DetailType": "AccountBasedExpenseLineDetail", "AccountBasedExpenseLineDetail": {"AccountRef": {"value": "77", "name": "Utilities:Telephone"}, "BillableStatus": "NotBillable", "TaxCodeRef": {"value": "NON"}}}], "VendorRef": {"value": "32", "name": "Cal Telephone"}, "APAccountRef": {"value": "33", "name": "Accounts Payable (A/P)"}, "TotalAmt": 56.5}, {"DueDate": "2024-12-07", "VendorAddr": {"Id": "43", "Line1": "P.O. Box 147", "City": "Bayshore", "CountrySubDivisionCode": "CA", "PostalCode": "94326", "Lat": "45.2720537", "Long": "-79.7935909"}, "Balance": 315.0, "domain": "QBO", "sparse": False, "Id": "108", "SyncToken": "0", "MetaData": {"CreateTime": "2024-12-07T12:36:59-08:00", "LastModifiedByRef": {"value": "9341453721658458"}, "LastUpdatedTime": "2024-12-07T12:36:59-08:00"}, "TxnDate": "2024-12-07", "CurrencyRef": {"value": "USD", "name": "United States Dollar"}, "Line": [{"Id": "1", "LineNum": 1, "Amount": 315.0, "LinkedTxn": [], "DetailType": "AccountBasedExpenseLineDetail", "AccountBasedExpenseLineDetail": {"AccountRef": {"value": "69", "name": "Legal & Professional Fees:Accounting"}, "BillableStatus": "NotBillable", "TaxCodeRef": {"value": "NON"}}}], "VendorRef": {"value": "49", "name": "Robertson & Associates"}, "APAccountRef": {"value": "33", "name": "Accounts Payable (A/P)"}, "TotalAmt": 315.0}, {"SalesTermRef": {"value": "3"}, "DueDate": "2024-12-21", "VendorAddr": {"Id": "36", "Line1": "P.O.Box 357", "City": "South Orange", "CountrySubDivisionCode": "NJ", "PostalCode": "07079", "Lat": "40.7489277", "Long": "-74.2609903"}, "Balance": 0, "domain": "QBO", "sparse": False, "Id": "24", "SyncToken": "1", "MetaData": {"CreateTime": "2024-12-04T15:31:20-08:00", "LastModifiedByRef": {"value": "9341453721658458"}, "LastUpdatedTime": "2024-12-06T13:43:08-08:00"}, "TxnDate": "2024-11-21", "CurrencyRef": {"value": "USD", "name": "United States Dollar"}, "LinkedTxn": [{"TxnId": "104", "TxnType": "BillPaymentCheck"}], "Line": [{"Id": "1", "LineNum": 1, "Description": "Building Lease", "Amount": 900.0, "LinkedTxn": [], "DetailType": "AccountBasedExpenseLineDetail", "AccountBasedExpenseLineDetail": {"AccountRef": {"value": "17", "name": "Rent or Lease"}, "BillableStatus": "NotBillable", "TaxCodeRef": {"value": "NON"}}}], "VendorRef": {"value": "40", "name": "Hall Properties"}, "APAccountRef": {"value": "33", "name": "Accounts Payable (A/P)"}, "TotalAmt": 900.0}, {"SalesTermRef": {"value": "3"}, "DueDate": "2024-09-04", "VendorAddr": {"Id": "43", "Line1": "P.O. Box 147", "City": "Bayshore", "CountrySubDivisionCode": "CA", "PostalCode": "94326", "Lat": "45.2720537", "Long": "-79.7935909"}, "Balance": 0, "domain": "QBO", "sparse": False, "Id": "90", "SyncToken": "1", "MetaData": {"CreateTime": "2024-12-06T13:18:27-08:00", "LastModifiedByRef": {"value": "9341453721658458"}, "LastUpdatedTime": "2024-12-06T13:19:24-08:00"}, "TxnDate": "2024-08-05", "CurrencyRef": {"value": "USD", "name": "United States Dollar"}, "PrivateNote": "Lawyer fees related to Startup", "LinkedTxn": [{"TxnId": "91", "TxnType": "BillPaymentCheck"}], "Line": [{"Id": "1", "LineNum": 1, "Amount": 300.0, "LinkedTxn": [], "DetailType": "AccountBasedExpenseLineDetail", "AccountBasedExpenseLineDetail": {"AccountRef": {"value": "71", "name": "Legal & Professional Fees:Lawyer"}, "BillableStatus": "NotBillable", "TaxCodeRef": {"value": "NON"}}}], "VendorRef": {"value": "49", "name": "Robertson & Associates"}, "APAccountRef": {"value": "33", "name": "Accounts Payable (A/P)"}, "TotalAmt": 300.0}, {"DueDate": "2024-11-22", "VendorAddr": {"Id": "45", "Line1": "3948 Elm St.", "City": "Middlefield", "CountrySubDivisionCode": "CA", "PostalCode": "94482", "Lat": "37.4604972", "Long": "-122.1547528"}, "Balance": 0, "domain": "QBO", "sparse": False, "Id": "3", "SyncToken": "1", "MetaData": {"CreateTime": "2024-11-30T10:42:31-08:00", "LastModifiedByRef": {"value": "9341453721658458"}, "LastUpdatedTime": "2024-12-06T13:06:58-08:00"}, "TxnDate": "2024-11-22", "CurrencyRef": {"value": "USD", "name": "United States Dollar"}, "PrivateNote": "Opening Balance", "LinkedTxn": [{"TxnId": "82", "TxnType": "BillPaymentCheck"}], "Line": [{"Id": "1", "LineNum": 1, "Amount": 666.0, "LinkedTxn": [], "DetailType": "AccountBasedExpenseLineDetail", "AccountBasedExpenseLineDetail": {"AccountRef": {"value": "14", "name": "Miscellaneous"}, "BillableStatus": "NotBillable", "TaxCodeRef": {"value": "NON"}}}], "VendorRef": {"value": "51", "name": "Tim Philip Masonry"}, "APAccountRef": {"value": "33", "name": "Accounts Payable (A/P)"}, "TotalAmt": 666.0}, {"DueDate": "2024-10-31", "VendorAddr": {"Id": "37", "Line1": "42 Main St.", "City": "Middlefield", "CountrySubDivisionCode": "CA", "PostalCode": "94303", "Lat": "37.445013", "Long": "-122.1391443"}, "Balance": 0, "domain": "QBO", "sparse": False, "Id": "2", "SyncToken": "1", "MetaData": {"CreateTime": "2024-11-30T10:26:56-08:00", "LastModifiedByRef": {"value": "9341453721658458"}, "LastUpdatedTime": "2024-12-06T13:01:57-08:00"}, "TxnDate": "2024-10-31", "CurrencyRef": {"value": "USD", "name": "United States Dollar"}, "PrivateNote": "Opening Balance", "LinkedTxn": [{"TxnId": "79", "TxnType": "BillPaymentCheck"}], "Line": [{"Id": "1", "LineNum": 1, "Amount": 250.0, "LinkedTxn": [], "DetailType": "AccountBasedExpenseLineDetail", "AccountBasedExpenseLineDetail": {"AccountRef": {"value": "14", "name": "Miscellaneous"}, "BillableStatus": "NotBillable", "TaxCodeRef": {"value": "NON"}}}], "VendorRef": {"value": "41", "name": "Hicks Hardware"}, "APAccountRef": {"value": "33", "name": "Accounts Payable (A/P)"}, "TotalAmt": 250.0}, {"SalesTermRef": {"value": "3"}, "DueDate": "2024-11-22", "VendorAddr": {"Id": "42", "Line1": "4 Main St.", "City": "Palo Alto", "CountrySubDivisionCode": "CA", "PostalCode": "94303", "Lat": "37.445013", "Long": "-122.1391443"}, "Balance": 86.44, "domain": "QBO", "sparse": False, "Id": "78", "SyncToken": "0", "MetaData": {"CreateTime": "2024-12-06T13:00:36-08:00", "LastModifiedByRef": {"value": "9341453721658458"}, "LastUpdatedTime": "2024-12-06T13:00:36-08:00"}, "TxnDate": "2024-10-23", "CurrencyRef": {"value": "USD", "name": "United States Dollar"}, "Line": [{"Id": "1", "LineNum": 1, "Amount": 86.44, "LinkedTxn": [], "DetailType": "AccountBasedExpenseLineDetail", "AccountBasedExpenseLineDetail": {"AccountRef": {"value": "76", "name": "Utilities:Gas and Electric"}, "BillableStatus": "NotBillable", "TaxCodeRef": {"value": "NON"}}}], "VendorRef": {"value": "48", "name": "PG&E"}, "APAccountRef": {"value": "33", "name": "Accounts Payable (A/P)"}, "TotalAmt": 86.44}, {"SalesTermRef": {"value": "3"}, "DueDate": "2024-12-21", "VendorAddr": {"Id": "42", "Line1": "4 Main St.", "City": "Palo Alto", "CountrySubDivisionCode": "CA", "PostalCode": "94303", "Lat": "37.445013", "Long": "-122.1391443"}, "Balance": 0, "domain": "QBO", "sparse": False, "Id": "35", "SyncToken": "1", "MetaData": {"CreateTime": "2024-12-05T11:10:57-08:00", "LastModifiedByRef": {"value": "9341453721658458"}, "LastUpdatedTime": "2024-12-06T12:57:18-08:00"}, "TxnDate": "2024-11-21", "CurrencyRef": {"value": "USD", "name": "United States Dollar"}, "LinkedTxn": [{"TxnId": "77", "TxnType": "BillPaymentCheck"}], "Line": [{"Id": "1", "LineNum": 1, "Amount": 114.09, "LinkedTxn": [], "DetailType": "AccountBasedExpenseLineDetail", "AccountBasedExpenseLineDetail": {"AccountRef": {"value": "76", "name": "Utilities:Gas and Electric"}, "BillableStatus": "NotBillable", "TaxCodeRef": {"value": "NON"}}}], "VendorRef": {"value": "48", "name": "PG&E"}, "APAccountRef": {"value": "33", "name": "Accounts Payable (A/P)"}, "TotalAmt": 114.09}, {"SalesTermRef": {"value": "3"}, "DueDate": "2024-12-21", "VendorAddr": {"Id": "33", "Line1": "10 Main St.", "City": "Palo Alto", "CountrySubDivisionCode": "CA", "PostalCode": "94303", "Lat": "37.445013", "Long": "-122.1391443"}, "Balance": 0, "domain": "QBO", "sparse": False, "Id": "21", "SyncToken": "1", "MetaData": {"CreateTime": "2024-12-04T15:27:53-08:00", "LastModifiedByRef": {"value": "9341453721658458"}, "LastUpdatedTime": "2024-12-05T11:44:29-08:00"}, "TxnDate": "2024-11-21", "CurrencyRef": {"value": "USD", "name": "United States Dollar"}, "LinkedTxn": [{"TxnId": "50", "TxnType": "BillPaymentCheck"}], "Line": [{"Id": "1", "LineNum": 1, "Description": "Monthly Phone Bill", "Amount": 74.36, "LinkedTxn": [], "DetailType": "AccountBasedExpenseLineDetail", "AccountBasedExpenseLineDetail": {"AccountRef": {"value": "77", "name": "Utilities:Telephone"}, "BillableStatus": "NotBillable", "TaxCodeRef": {"value": "NON"}}}], "VendorRef": {"value": "32", "name": "Cal Telephone"}, "APAccountRef": {"value": "33", "name": "Accounts Payable (A/P)"}, "TotalAmt": 74.36}, {"SalesTermRef": {"value": "3"}, "DueDate": "2025-01-04", "Balance": 755.0, "domain": "QBO", "sparse": False, "Id": "44", "SyncToken": "0", "MetaData": {"CreateTime": "2024-12-05T11:31:42-08:00", "LastModifiedByRef": {"value": "9341453721658458"}, "LastUpdatedTime": "2024-12-05T11:31:42-08:00"}, "TxnDate": "2024-12-05", "CurrencyRef": {"value": "USD", "name": "United States Dollar"}, "Line": [{"Id": "1", "LineNum": 1, "Description": "Repairs on the truck", "Amount": 755.0, "LinkedTxn": [], "DetailType": "AccountBasedExpenseLineDetail", "AccountBasedExpenseLineDetail": {"AccountRef": {"value": "75", "name": "Maintenance and Repair:Equipment Repairs"}, "BillableStatus": "NotBillable", "TaxCodeRef": {"value": "NON"}}}], "VendorRef": {"value": "36", "name": "Diego's Road Warrior Bodyshop"}, "APAccountRef": {"value": "33", "name": "Accounts Payable (A/P)"}, "TotalAmt": 755.0}, {"SalesTermRef": {"value": "2"}, "DueDate": "2024-12-08", "VendorAddr": {"Id": "31", "Line1": "15 Main St.", "City": "Palo Alto", "CountrySubDivisionCode": "CA", "PostalCode": "94303", "Lat": "37.445013", "Long": "-122.1391443"}, "Balance": 0, "domain": "QBO", "sparse": False, "Id": "18", "SyncToken": "1", "MetaData": {"CreateTime": "2024-12-04T15:21:03-08:00", "LastModifiedByRef": {"value": "9341453721658458"}, "LastUpdatedTime": "2024-12-05T11:13:46-08:00"}, "TxnDate": "2024-11-23", "CurrencyRef": {"value": "USD", "name": "United States Dollar"}, "LinkedTxn": [{"TxnId": "37", "TxnType": "BillPaymentCheck"}], "Line": [{"Id": "1", "LineNum": 1, "Amount": 75.0, "LinkedTxn": [], "DetailType": "AccountBasedExpenseLineDetail", "AccountBasedExpenseLineDetail": {"AccountRef": {"value": "69", "name": "Legal & Professional Fees:Accounting"}, "BillableStatus": "NotBillable", "TaxCodeRef": {"value": "NON"}}}], "VendorRef": {"value": "30", "name": "Books by Bessie"}, "APAccountRef": {"value": "33", "name": "Accounts Payable (A/P)"}, "TotalAmt": 75.0}, {"DueDate": "2024-11-30", "VendorAddr": {"Id": "32", "Line1": "P.O. Box 5", "City": "Middlefield", "CountrySubDivisionCode": "CA", "PostalCode": "94482", "Lat": "43.8249453", "Long": "-79.2639122"}, "Balance": 0, "domain": "QBO", "sparse": False, "Id": "1", "SyncToken": "1", "MetaData": {"CreateTime": "2024-11-30T10:12:02-08:00", "LastModifiedByRef": {"value": "9341453721658458"}, "LastUpdatedTime": "2024-12-04T15:28:48-08:00"}, "TxnDate": "2024-11-30", "CurrencyRef": {"value": "USD", "name": "United States Dollar"}, "PrivateNote": "Opening Balance", "LinkedTxn": [{"TxnId": "22", "TxnType": "BillPaymentCheck"}], "Line": [{"Id": "1", "LineNum": 1, "Amount": 2000.0, "LinkedTxn": [], "DetailType": "AccountBasedExpenseLineDetail", "AccountBasedExpenseLineDetail": {"AccountRef": {"value": "14", "name": "Miscellaneous"}, "BillableStatus": "NotBillable", "TaxCodeRef": {"value": "NON"}}}], "VendorRef": {"value": "31", "name": "Brosnahan Insurance Agency"}, "APAccountRef": {"value": "33", "name": "Accounts Payable (A/P)"}, "TotalAmt": 2000.0}, {"SalesTermRef": {"value": "5"}, "DueDate": "2024-12-10", "VendorAddr": {"Id": "32", "Line1": "P.O. Box 5", "City": "Middlefield", "CountrySubDivisionCode": "CA", "PostalCode": "94482", "Lat": "43.8249453", "Long": "-79.2639122"}, "Balance": 241.23, "domain": "QBO", "sparse": False, "Id": "19", "SyncToken": "0", "MetaData": {"CreateTime": "2024-12-04T15:24:48-08:00", "LastModifiedByRef": {"value": "9341453721658458"}, "LastUpdatedTime": "2024-12-04T15:24:48-08:00"}, "TxnDate": "2024-11-30", "CurrencyRef": {"value": "USD", "name": "United States Dollar"}, "Line": [{"Id": "1", "LineNum": 1, "Amount": 241.23, "LinkedTxn": [], "DetailType": "AccountBasedExpenseLineDetail", "AccountBasedExpenseLineDetail": {"AccountRef": {"value": "11", "name": "Insurance"}, "BillableStatus": "NotBillable", "TaxCodeRef": {"value": "NON"}}}], "VendorRef": {"value": "31", "name": "Brosnahan Insurance Agency"}, "APAccountRef": {"value": "33", "name": "Accounts Payable (A/P)"}, "TotalAmt": 241.23}], "startPosition": 1, "maxResults": 15, "totalCount": 15}, "time": "2025-02-19T12:35:45.986-08:00"}
def extract_bills(json_data):
    result = []
    bills = json_data.get("QueryResponse", {}).get("Bill", [])
    for bill in bills:
        bill_data = {
            "DueDate": bill.get("DueDate"),
            "VendorId": bill.get("VendorAddr", {}).get("Id"),
            "VendorLine1": bill.get("VendorAddr", {}).get("Line1"),
            "VendorCity": bill.get("VendorAddr", {}).get("City"),
            "VendorCountrySubDivisionCode": bill.get("VendorAddr", {}).get("CountrySubDivisionCode"),
            "VendorPostalCode": bill.get("VendorAddr", {}).get("PostalCode"),
            "VendorLat": bill.get("VendorAddr", {}).get("Lat"),
            "VendorLong": bill.get("VendorAddr", {}).get("Long"),
            "Balance": bill.get("Balance"),
            "Id": bill.get("Id"),
            "SyncToken": bill.get("SyncToken"),
            "CreateTime": bill.get("MetaData", {}).get("CreateTime"),
            "LastModifiedByRef": bill.get("MetaData", {}).get("LastModifiedByRef", {}).get("value"),
            "LastUpdatedTime": bill.get("MetaData", {}).get("LastUpdatedTime"),
            "TxnDate": bill.get("TxnDate"),
            "CurrencyValue": bill.get("CurrencyRef", {}).get("value"),
            "CurrencyName": bill.get("CurrencyRef", {}).get("name"),
            "VendorRefValue": bill.get("VendorRef", {}).get("value"),
            "VendorRefName": bill.get("VendorRef", {}).get("name"),
            "APAccountRefValue": bill.get("APAccountRef", {}).get("value"),
            "APAccountRefName": bill.get("APAccountRef", {}).get("name"),
            "TotalAmt": bill.get("TotalAmt"),
            "LineItems": []
        }
        for line in bill.get("Line", []):
            line_item = {
                "LineId": line.get("Id"),
                "LineNum": line.get("LineNum"),
                "Description": line.get("Description"),
                "Amount": line.get("Amount"),
                "DetailType": line.get("DetailType"),
                "BillableStatus": line.get("ItemBasedExpenseLineDetail", {}).get("BillableStatus"),
                "ItemRefValue": line.get("ItemBasedExpenseLineDetail", {}).get("ItemRef", {}).get("value"),
                "ItemRefName": line.get("ItemBasedExpenseLineDetail", {}).get("ItemRef", {}).get("name"),
                "UnitPrice": line.get("ItemBasedExpenseLineDetail", {}).get("UnitPrice"),
                "Qty": line.get("ItemBasedExpenseLineDetail", {}).get("Qty"),
                "TaxCodeRef": line.get("ItemBasedExpenseLineDetail", {}).get("TaxCodeRef", {}).get("value")
            }
            bill_data["LineItems"].append(line_item)
        result.append(bill_data)
    return result

result = extract_bills(json_data)
print(result)